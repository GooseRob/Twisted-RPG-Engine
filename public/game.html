<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Twisted RPG</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #0b0f14; color: #e8eef6; font-family: 'Segoe UI', Arial, sans-serif; overflow: hidden; }
    #gameCanvas { display: block; margin: 0 auto; background: #0f1620; }

    /* â”€â”€ HUD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #hud {
      position: fixed; left: 10px; top: 10px; width: 290px;
      background: rgba(5,8,14,0.88); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px; padding: 12px 14px; z-index: 10;
    }
    #hudNameRow { display: flex; align-items: center; gap: 7px; margin-bottom: 10px; }
    #charName   { font-weight: 700; font-size: 14px; flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    #hudLevel   {
      font-size: 11px; color: #bb86fc; font-weight: 700;
      background: rgba(187,134,252,0.12); border: 1px solid rgba(187,134,252,0.25);
      border-radius: 10px; padding: 2px 8px; white-space: nowrap; flex-shrink: 0;
    }
    #playerCount { font-size: 11px; color: #484f58; flex-shrink: 0; }

    .hud-bar-row { display: flex; align-items: center; gap: 7px; margin-bottom: 5px; }
    .hud-bar-lbl { font-size: 10px; font-weight: 700; width: 20px; text-align: right; flex-shrink: 0; letter-spacing: .4px; }
    .hud-bar-lbl.hp { color: #e74c3c; } .hud-bar-lbl.mp { color: #2e86c1; }
    .hud-bar-lbl.xp { color: #bb86fc; } .hud-bar-lbl.lb { color: #f39c12; }
    .hud-track  { flex: 1; height: 9px; background: rgba(255,255,255,0.07); border-radius: 5px; overflow: hidden; }
    .hud-fill   { height: 100%; border-radius: 5px; transition: width 0.35s ease; width: 0%; }
    #hpFill { background: linear-gradient(90deg,#c0392b,#e74c3c); }
    #mpFill { background: linear-gradient(90deg,#1a5276,#2e86c1); }
    #xpFill { background: linear-gradient(90deg,#7d3c98,#bb86fc); }
    #lbFill { background: linear-gradient(90deg,#b7770d,#f39c12); }
    .hud-val { font-size: 10px; width: 68px; text-align: right; flex-shrink: 0; font-variant-numeric: tabular-nums; }
    #hpVal { color: #e74c3c; } #mpVal { color: #2e86c1; } #xpVal { color: #9b59b6; font-size:9px; } #lbVal { color: #f39c12; }

    .hud-divider { border: none; border-top: 1px solid rgba(255,255,255,0.06); margin: 8px 0; }
    #hudMeta { display: flex; justify-content: space-between; font-size: 10px; color: #484f58; }

    /* â”€â”€ QUEST TRACKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #questTracker {
      position: fixed; left: 10px; width: 290px;
      background: rgba(5,8,14,0.82); border: 1px solid rgba(187,134,252,0.18);
      border-radius: 10px; padding: 9px 12px; z-index: 9;
      display: none; font-size: 11px;
    }
    #qtTitle { color: #bb86fc; font-weight: 700; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
    .qt-name { color: #c9d1d9; font-weight: 600; margin-bottom: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .qt-obj  { display: flex; align-items: center; gap: 5px; color: #484f58; font-size: 10px; margin-bottom: 2px; }
    .qt-track{ flex: 1; height: 4px; background: rgba(255,255,255,0.07); border-radius: 2px; overflow: hidden; }
    .qt-fill { height: 100%; background: #bb86fc; border-radius: 2px; transition: width .35s; }
    .qt-obj.done { color: #3fb950; } .qt-obj.done .qt-fill { background: #3fb950; }
    #qtMore  { color: #484f58; font-size: 10px; margin-top: 4px; }

    /* â”€â”€ TOP-RIGHT BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #topButtons { position: fixed; right: 10px; top: 10px; z-index: 10; display: flex; flex-direction: column; gap: 6px; }
    .hud-btn {
      padding: 9px 14px; border-radius: 9px; cursor: pointer;
      font-size: 12px; font-weight: 600; transition: .15s; white-space: nowrap;
      font-family: inherit;
    }
    #invBtn  { border: 1px solid rgba(255,255,255,0.12); background: rgba(5,8,14,0.82); color: #e8eef6; }
    #invBtn:hover  { background: rgba(255,255,255,0.07); }
    #questBtn{ border: 1px solid rgba(187,134,252,0.3);  background: rgba(5,8,14,0.82); color: #bb86fc; }
    #questBtn:hover{ background: rgba(187,134,252,0.1); }
    #charBtn { border: 1px solid rgba(3,218,198,0.25);   background: rgba(5,8,14,0.82); color: #03dac6; }
    #charBtn:hover { background: rgba(3,218,198,0.08); }
    #partyBtn{ border: 1px solid rgba(63,185,80,0.25);   background: rgba(5,8,14,0.82); color: #3fb950; }
    #partyBtn:hover{ background: rgba(63,185,80,0.08); }

    /* â”€â”€ DIALOGUE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #dialogueBox {
      position: fixed; left: 50%; bottom: 16px; transform: translateX(-50%);
      width: min(900px, calc(100% - 24px));
      background: rgba(5,8,14,0.92); border: 1px solid rgba(255,255,255,0.12);
      border-radius: 14px; padding: 14px; z-index: 20; display: none;
    }
    #npcName { font-weight: 800; margin-bottom: 6px; color: #bb86fc; }
    #npcText { line-height: 1.4; white-space: pre-wrap; }
    #npcChoices { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
    .choiceBtn {
      padding: 10px 12px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.16); background: rgba(255,255,255,0.06);
      color: #e8eef6; cursor: pointer; font-size: 13px;
    }
    .choiceBtn:hover { background: rgba(255,255,255,0.12); }
    #npcInstructions { margin-top: 10px; font-size: 11px; opacity: 0.6; }

    /* â”€â”€ NOTIFICATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #notifContainer {
      position: fixed; right: 10px; bottom: 10px; width: 300px;
      z-index: 30; display: flex; flex-direction: column; gap: 8px; pointer-events: none;
    }
    .notif {
      padding: 10px 14px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1); background: rgba(5,8,14,0.9);
      font-size: 12px; animation: nfIn .2s ease;
    }
    @keyframes nfIn { from { opacity:0; transform:translateX(16px); } to { opacity:1; } }

    /* â”€â”€ HOTKEY HINT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #hudHotkeys {
      position: fixed; left: 10px; bottom: 8px;
      font-size: 10px; color: #21262d; pointer-events: none; z-index: 5; line-height: 1.7;
    }

    @media (max-width:600px) { #hud, #questTracker { width: calc(100% - 20px); } }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="512" height="512"></canvas>

  <!-- Main HUD -->
  <div id="hud">
    <div id="hudNameRow">
      <div id="charName">Loadingâ€¦</div>
      <div id="hudLevel">Lv. 1</div>
      <div id="playerCount">ğŸ‘¥ 0</div>
    </div>

    <div class="hud-bar-row">
      <div class="hud-bar-lbl hp">HP</div>
      <div class="hud-track"><div class="hud-fill" id="hpFill"></div></div>
      <div class="hud-val" id="hpVal">0 / 0</div>
    </div>
    <div class="hud-bar-row">
      <div class="hud-bar-lbl mp">MP</div>
      <div class="hud-track"><div class="hud-fill" id="mpFill"></div></div>
      <div class="hud-val" id="mpVal">0 / 0</div>
    </div>
    <div class="hud-bar-row">
      <div class="hud-bar-lbl xp">XP</div>
      <div class="hud-track"><div class="hud-fill" id="xpFill"></div></div>
      <div class="hud-val" id="xpVal">0 / â€”</div>
    </div>
    <div class="hud-bar-row">
      <div class="hud-bar-lbl lb">LB</div>
      <div class="hud-track"><div class="hud-fill" id="lbFill"></div></div>
      <div class="hud-val" id="lbVal">0%</div>
    </div>

    <hr class="hud-divider" />

    <div id="hudMeta">
      <div>ğŸ“ <span id="mapName">â€”</span></div>
      <div>X:<span id="coordX">0</span> Y:<span id="coordY">0</span></div>
    </div>
  </div>

  <!-- Mini Quest Tracker â€” positioned below HUD by game_engine.js -->
  <div id="questTracker">
    <div id="qtTitle">ğŸ“œ Active Quest</div>
    <div id="qtBody"></div>
    <div id="qtMore"></div>
  </div>

  <!-- Top-right buttons -->
  <div id="topButtons">
    <button class="hud-btn" id="invBtn"
      onclick="if(typeof Panels!=='undefined')Panels.openInventory()" title="[I] Inventory">ğŸ’ Inventory</button>
    <button class="hud-btn" id="questBtn"
      onclick="if(typeof QuestUI!=='undefined')QuestUI.toggle()" title="[Q] Quests">ğŸ“œ Quests</button>
    <button class="hud-btn" id="charBtn"
      onclick="if(typeof Panels!=='undefined')Panels.openCharacter()" title="[C] Character">ğŸ“‹ Character</button>
    <button class="hud-btn" id="partyBtn"
      onclick="if(typeof PartyUI!=='undefined')PartyUI.toggle()" title="[P] Party &amp; Friends">âš”ï¸ Party</button>
    <button class="hud-btn" id="guildBtn"
      onclick="if(typeof GuildUI!=='undefined')GuildUI.toggle()" title="[G] Guild">ğŸ° Guild</button>
    <button class="hud-btn" id="mapBtn"
      onclick="if(typeof WorldMapUI!=='undefined')WorldMapUI.toggle()" title="[M] World Map">ğŸ—ºï¸ Map</button>
  </div>

  <!-- NPC / Event Dialogue -->
  <div id="dialogueBox">
    <div id="npcName"></div>
    <div id="npcText"></div>
    <div id="npcChoices"></div>
    <div id="npcInstructions">Press SPACE or ENTER to close.</div>
  </div>

  <div id="notifContainer"></div>

  <div id="hudHotkeys">
    WASD / Arrows&nbsp; Move &nbsp;Â·&nbsp; E&nbsp; Interact &nbsp;Â·&nbsp; I&nbsp; Inventory
    &nbsp;Â·&nbsp; C&nbsp; Character &nbsp;Â·&nbsp; Q&nbsp; Quests &nbsp;Â·&nbsp; P&nbsp; Party &nbsp;Â·&nbsp; G&nbsp; Guild &nbsp;Â·&nbsp; M&nbsp; Map &nbsp;Â·&nbsp; Enter&nbsp; Chat
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="js/panels_ui.js"></script>
  <script src="js/battle_ui.js"></script>
  <script src="js/chat_ui.js"></script>
  <script src="js/quest_ui.js"></script>
  <script src="js/party_ui.js"></script>
  <script src="js/guild_ui.js"></script>
  <script src="js/trade_ui.js"></script>
  <script src="js/world_map_ui.js"></script>
  <script src="js/nearby_players_ui.js"></script>
  <script src="js/minimap_ui.js"></script>
  <script src="js/game_engine.js"></script>
</body>
</html>
